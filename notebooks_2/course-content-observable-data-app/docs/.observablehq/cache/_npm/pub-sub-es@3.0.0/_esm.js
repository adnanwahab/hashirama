/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/pub-sub-es@3.0.0/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const e=new window.BroadcastChannel("pub-sub-es"),s=(e,s)=>"string"==typeof e&&s?e.toLowerCase():e,n=(e,n)=>(t,o,a=Number.POSITIVE_INFINITY)=>{const c=s(t,n?.caseInsensitive),r=e[c]||[];return r.push({handler:o,times:+a||Number.POSITIVE_INFINITY}),e[c]=r,{event:c,handler:o}};function t(e,n){return function(t,o){let a,c;(e=>"object"==typeof e)(t)?(c=t.handler,a=t.event):(a=t,c=o);const r=s(a,n?.caseInsensitive),i=e[r];if(!i)return;const l=i.findIndex((e=>e.handler===c));-1===l||l>=i.length||i.splice(l,1)}}const o=(n,o)=>{const a=t(n);return(...t)=>{const[c,r,i]=t,l=s(c,o?.caseInsensitive),u=n[l];if(!(e=>Boolean(e))(u))return;const b=[...u];for(const e of b)--e.times<1&&a(l,e.handler);const d=()=>{for(const e of b)e.handler(r)};if((void 0!==i?.async?i.async:o?.async)?setTimeout(d,0):d(),o?.isGlobal&&!i?.isNoGlobalBroadcast)try{e.postMessage({event:l,news:r})}catch(e){if(!(e instanceof Error&&"DataCloneError"===e.name))throw e;console.warn(`Could not broadcast '${l.toString()}' globally. Payload is not clonable.`)}}};const a=e=>()=>{for(const n of(s=e,Object.keys(s)))delete e[n];var s},c=e=>{const s=Boolean(e?.async),c=Boolean(e?.caseInsensitive),r=e?.stack||{};return{publish:o(r,{async:s,caseInsensitive:c}),subscribe:n(r,{caseInsensitive:c}),unsubscribe:t(r,{caseInsensitive:c}),clear:a(r),stack:r}},r={},i={publish:o(r,{isGlobal:!0}),subscribe:n(r),unsubscribe:t(r),clear:a(r),stack:r};e.onmessage=({data:{event:e,news:s}})=>i.publish(e,s,{isNoGlobalBroadcast:!0});export{c as createPubSub,c as default,i as globalPubSub};
