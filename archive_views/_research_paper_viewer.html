<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
<script type="module">
  renderPDF("static/alan_kay/pdf/Kay_How.pdf");
  renderPDF("https://idl.cs.washington.edu/files/2023-LivingPapers-UIST.pdf");
  renderPDF("https://dynamicland.org/2024/The_communal_science_lab.pdf");

  async function renderPDF(url) {
    // Create a unique container for each PDF
    const container = document.createElement("div");
    const uniqueId = `pdf-${Math.random().toString(36).substr(2, 9)}`;
    container.id = uniqueId;
    container.innerHTML = `
      <canvas class="pdf-canvas"></canvas>
      <div class="page-num"></div>
      <div class="prev-page">prev</div>
      <div class="next-page">next</div>
      <div class="img-carousel">make this work pls</div>
    `;
    document.body.appendChild(container);

    // ... (keep the existing image loading code)

    let pdfDoc = null,
      pageNum = 1,
      pageRendering = false,
      pageNumPending = null,
      scale = 1.5,
      canvas = container.querySelector(".pdf-canvas"),
      ctx = canvas.getContext("2d");

    // Load the PDF file
    pdfjsLib.getDocument(url).promise.then((pdfDoc_) => {
      pdfDoc = pdfDoc_;
      renderPage(pageNum);
    });

    // Render a specific page
    function renderPage(num) {
      pageRendering = true;
      pdfDoc.getPage(num).then((page) => {
        const viewport = page.getViewport({ scale: scale });
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        const renderContext = {
          canvasContext: ctx,
          viewport: viewport,
        };
        const renderTask = page.render(renderContext);

        renderTask.promise.then(() => {
          pageRendering = false;
          if (pageNumPending !== null) {
            renderPage(pageNumPending);
            pageNumPending = null;
          }
        });
      });

      container.querySelector(".page-num").textContent = num;
    }

    // ... (keep the existing queueRenderPage function)

    // Next page
    container.querySelector(".next-page").addEventListener("click", () => {
      if (pageNum >= pdfDoc.numPages) {
        return;
      }
      pageNum++;
      queueRenderPage(pageNum);
    });

    // Previous page
    container.querySelector(".prev-page").addEventListener("click", () => {
      if (pageNum <= 1) {
        return;
      }
      pageNum--;
      queueRenderPage(pageNum);
    });
  }
</script>
